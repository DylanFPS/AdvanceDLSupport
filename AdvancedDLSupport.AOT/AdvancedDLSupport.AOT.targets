<Project>
  <PropertyGroup Condition="'$(AOTOutputDirectory)' == ''">
    <AOTOutputDirectory>adl-aot</AOTOutputDirectory>
  </PropertyGroup>
  <Target Name="IncludeAOTAssemblies" BeforeTargets="BeforeBuild">
    <ItemGroup>
      <AdditionalFiles Include="$(AOTOutputDirectory)/*.dll" InProject="false" CopyToOutputDirectory="PreserveNewest" />
    </ItemGroup>
  </Target>
  <Target Name="BuildAOTAssemblies" DependsOnTargets="Build">
    <GenerateDLDynamicAssemblies Input="$(TargetPath)" Output="$(ProjectDir)/$(AOTOutputDirectory)" />
    <Copy SourceFiles="$(ProjectDir)/$(AOTOutputDirectory)/*.dll"
          DestinationFiles="$(TargetDir)/$(AOTOutputDirectory)/*.dll" />
  </Target>
</Project>